<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" 
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
        crossorigin="anonymous">

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>

    <title>main</title>
</head>

<style>
    body {
        display: flex;
        flex-direction: column;

        font-family: 'Inter';
        font-style: normal;
        color: #000000;
    }

    p {
        margin-left: 15px;
    }

    a {
        text-align: center;
        text-decoration: none; /* 링크의 밑줄 제거 */
        color: inherit;        /* 링크의 색상 제거 */ 
    }

    a:hover {
        color: rgb(156, 156, 156);
        background-color: transparent;
        text-decoration: none;
    }
    
    /* class ----------------------------- */
    .head_container {
        margin-left : 80px;
        margin-right: 80px;
    }

    .head_nev_1 {
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 100px;

        margin-bottom: 30px;
    }

    .head_nev_2 {
        display: flex;
        justify-content: space-between;
    }
    
    .head_search {
        display: flex;
        align-items: center;
    }

    .head_list {
        display: flex;
        flex-direction: row;
    }
    
    /* class ----------------------------- */
    
    /* 상단 바 -----------------------------*/

    #title {
        font-weight: 400;
        font-size: 30px;

    }

    #login {
        font-family: 'Inter';
        font-style: normal;
        font-weight: 400;
        font-size: 25px;
    }

    #cam_search {
        margin-left: 0;
    }

    #search_box {
        width: 230px;
        height: 35px;

        background: #E5E5E5;
        border-radius: 25px;
        border: 0px;
        margin-left: 10px;
    }

    #line {
        height: 3px;

        background   : #ECECEC;
        border-radius: 10px;
        margin-top   : 10px;
        margin-bottom: 30px;
    }
    /* 상단 바 -----------------------------*/

    /* 검색결과 css */
    #search-container {
        display: flex;
        flex-direction: row;

        margin-left: 80px;
        margin-right: 80px;
    }

    /* #search-container img {
        width: 480px;
        height: 360px;
    } */

    /* .card {
        display: flex;
        flex-direction: row;
        align-items: center;
        width: 100%;
        margin-bottom: 10px;
        box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        overflow: hidden;
    } */

    .card {
        max-height: 500px;
        border: 0px;
        /* margin-left: 20px;
        margin-right: 20px; */
    }

    img {
        transition: top 0.2s ease-in-out;
    }

    .card img {
        box-shadow: 0px 5px 10px rgba(0, 0, 1, 0.3);
        border-radius: 20px;

    }

    .card img:hover {
        position: relative;
        top: -5px; /* 또는 다른 원하는 거리 */
    }

    /* .card-text {
        margin-left: 10px;
    }

    .card-text span {
        margin: 0;
        font-size: 18px;
        font-weight: bold;
    }

    .card-text p {
        margin: 0;
        font-size: 14px;
        color: #666;
    } */
/* 
    #cardId {
        display: block;

    } */

</style>


<body>
    <div class="head_container">
        <div class="head_nev_1">
            <h1 id="title">직캠 모아😙</h1>
            <h2 id="login">Login</h2>
        </div>
    
        <div class="head_nev_2">
            <div class="head_search">
                <p id="cam_search">직캠 검색</p>
                <input id="search_box" type="text" placeholder="   검색어를 입력하세요." title="검색">
                <button id="search-button">검색</button>
            </div>
        
            <div class="head_list">
                <p>아이돌 순위</p>
                <p>아이돌 프로필</p>
                <p>마이페이지</p>
            </div>
        </div>
    
        <div id="line"></div>

    <main class="mt-3">
        <div class="container">
            <div class="row mb-2">
                <div class="col-12">
                </div>
            </div>
            <div class="row g-3" id="search-container">
            </div>
        </div>
    </main>

</body>

<script>
    $(document).ready(function () {
        searchVideo();
    });

    function searchVideo() {
        $('#search-button').click(function() {
            
            let query = $('#search_box').val();
            let url = 'https://www.googleapis.com/youtube/v3/search';
            let params = {
                part: 'snippet',
                q: query,
                type: 'video',
                key: 'AIzaSyCJClqf3zSSC-ltsVXPWNKAoUbTAIwp7FM',
                maxResults: 10,
                order: 'relevance'
            };

            // 이전 검색 결과 지우기
            $('#search-container').html('');

            $.ajax({
                url: url,
                type: 'GET',
                data: params,
                success: function(response) {

                    // let tempHtml = ""
                    let items = response.items;
                    console.log("items-----------------",items[0])

                    // var viewCount = response.items[0].statistics.viewCount;
                    // console.log('동영상 조회수:', viewCount);

                    for (let i in items) {
                        let videoId      = items[i].id.videoId;
                        let thumbnailUrl = items[i].snippet.thumbnails.high.url;
                        let title        = items[i].snippet.title;
                        let description  = items[i].snippet.description;
                        
                        const exTitleKeywords = isKeywordsIncluded(title);
                        const exDescriptionKeywords  = isKeywordsIncluded(title);

                        if (exTitleKeywords || exDescriptionKeywords) {

                            tempHtml = `<div id="card_id" class="col-xl-4 col-lg-4 col-md-6">
                                            <div class="card" style="width: 18rem;">
                                                <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank">
                                                <img src="${thumbnailUrl}" class="card-img-top" alt="${title}">
                                                <div class="card-body">
                                                    <p class="card-title">${title}</p>
                                                </div>
                                                </a>
                                            </div>
                                        </div>`

                                $('#search-container').append(tempHtml)
                            }
                        }                         
                    },
                    error: function(response) {
                        console.log('Error: ' + response);
                    }
                });
            });    

            function isKeywordsIncluded(str) {
                const keywords = ['직캠', '캠', '뮤비', '뮤직비디오', '입덕', 'fancam', 'cam']
                const lowerCaseStr = str.toLowerCase();
                for (const keyword of keywords) {
                    if (lowerCaseStr.includes(keyword)) {
                    return true;
                    }
                }
                return false;
            }


            // function isShortsIncluded(str) {
            //     return str.toLowerCase().includes('shorts');
            //     // true or false 반환
            // }

            // const exShorts = isShortsIncluded(description);
            // if (!exShorts) { // false일때만 검색결과에 들어간다.

        //     $.ajax({
        //         url: url,
        //         type: 'GET',
        //         data: params,
        //         success: function(response) {
        //             let items = response.items;
        //             console.log("items-----------------",items)
        //             let tempHtml = '';
        //             $.each(items, function(index, item) {
        //                 let videoId = item.id.videoId;
        //                 let thumbnailUrl = item.snippet.thumbnails.high.url;
        //                 let title = item.snippet.title;
        //                 let description = item.snippet.description;
                        
                            // console.log("videoId-----------------",videoId)
                            // console.log("thumbnailUrl-----------------",thumbnailUrl)
                            // console.log("title-----------------",title)
                            // console.log("description-----------------",description)
                    
        //                 // Convert the image file format to JPG 
        //                 thumbnailUrl = thumbnailUrl.replace('png', 'jpg');

                        

        //                 tempHtml += `<div class="card" style="width: 20rem;">
        //                                 <a href="https://www.youtube.com/watch?v=${videoId}">
        //                                 <img src="${thumbnailUrl}" class="card-img-top" alt="${title}">
        //                                 </a>
        //                                 <div class="card-body">
        //                                     <h5 class="card-title">${title}</h5>
        //                                 </div>
        //                             </div>`
        //                 });

        //             $('#search-container').append(tempHtml)
        //         },
        //         error: function(response) {
        //             console.log('Error: ' + response);
        //         }
        //     });
        // });
    }


    
</script>
</html>